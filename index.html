<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Moon Dream | Handmade Candles & Wax Melts</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #6a4c93; /* ÎœÏ‰Î² Ï„Î·Ï‚ ÏƒÎµÎ»Î®Î½Î·Ï‚ */
            --secondary: #ffafcc; /* Î‘Ï€Î±Î»ÏŒ ÏÎ¿Î¶ */
            --dark: #2d2d2d;
            --light: #fffaf0; /* Cream background */
            --gold: #d4af37;
        }

        * { box-sizing: border-box; scroll-behavior: smooth; }
        body { font-family: 'Poppins', sans-serif; background-color: var(--light); color: var(--dark); margin: 0; }
        
        /* Typography */
        h1, h2, h3 { font-family: 'Playfair Display', serif; }

        /* Header & Nav */
        header { background: white; padding: 20px; text-align: center; box-shadow: 0 2px 10px rgba(0,0,0,0.05); position: sticky; top: 0; z-index: 1000; }
        .logo { font-size: 2.5rem; color: var(--primary); margin: 0; text-transform: uppercase; letter-spacing: 2px; }
        nav { display: flex; justify-content: center; gap: 30px; padding: 15px; background: white; border-bottom: 1px solid #eee; }
        nav a { text-decoration: none; color: var(--dark); font-weight: 600; font-size: 0.9rem; cursor: pointer; transition: 0.3s; }
        nav a:hover { color: var(--primary); }

        /* Hero Section */
        .hero { height: 40vh; display: flex; align-items: center; justify-content: center; background: linear-gradient(rgba(106, 76, 147, 0.1), rgba(106, 76, 147, 0.1)), url('https://images.unsplash.com/photo-1603006905003-be475563bc59?auto=format&fit=crop&q=80&w=1500'); background-size: cover; background-position: center; text-align: center; }
        .hero h2 { font-size: 3rem; color: var(--primary); text-shadow: 2px 2px 4px white; }

        /* Main Container */
        .container { max-width: 1200px; margin: 40px auto; padding: 0 20px; }
        .section-title { text-align: center; margin-bottom: 40px; font-size: 2rem; position: relative; }
        .section-title::after { content: ''; width: 60px; height: 3px; background: var(--primary); position: absolute; bottom: -10px; left: 50%; transform: translateX(-50%); }

        /* Products Grid */
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 30px; }
        .product-card { background: white; border-radius: 15px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.05); transition: 0.3s; position: relative; border: 1px solid #f0f0f0; }
        .product-card:hover { transform: translateY(-10px); box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .product-image { width: 100%; height: 250px; object-fit: cover; }
        .product-info { padding: 20px; text-align: center; }
        .product-info h3 { margin: 10px 0; font-size: 1.3rem; }
        .price { color: var(--primary); font-weight: 600; font-size: 1.2rem; margin-bottom: 15px; }
        .btn-buy { background: var(--primary); color: white; border: none; padding: 12px 25px; border-radius: 25px; cursor: pointer; font-weight: 600; width: 100%; transition: 0.3s; }
        .btn-buy:hover { background: var(--dark); }

        /* Admin & Forms */
        .admin-panel { display: none; background: white; padding: 30px; border-radius: 15px; border: 2px dashed var(--primary); margin-top: 50px; }
        .form-group { margin-bottom: 15px; }
        input, select, textarea { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-family: inherit; }
        .order-row { background: #fff; border-bottom: 1px solid #eee; }

        /* Floating Cart Icon */
        .cart-status { position: fixed; bottom: 20px; right: 20px; background: var(--primary); color: white; padding: 15px 25px; border-radius: 50px; box-shadow: 0 5px 15px rgba(0,0,0,0.2); cursor: pointer; z-index: 2000; }
    </style>
</head>
<body>

<header>
    <h1 class="logo">Moon Dream</h1>
</header>

<nav>
    <a onclick="showPage('shop')">ÎšÎ‘Î¤Î‘Î£Î¤Î—ÎœÎ‘</a>
    <a onclick="showPage('keria')">ÎšÎ•Î¡Î™Î‘</a>
    <a onclick="showPage('melts')">WAX MELTS</a>
    <a onclick="showPage('admin')" id="admin-link">ADMIN</a>
</nav>

<div class="hero">
    <h2>Î¦Ï‰Ï‚ ÎºÎ±Î¹ Î†ÏÏ‰Î¼Î± Î³Î¹Î± Ï„Î·Î½ Î¨Ï…Ï‡Î®</h2>
</div>

<div class="container" id="main-content">
    <div id="shop-view">
        <h2 class="section-title">Î— Î£Ï…Î»Î»Î¿Î³Î® Î¼Î±Ï‚</h2>
        <div id="products-grid" class="grid">
            </div>
    </div>

    <div id="admin-view" class="admin-panel">
        <h2 class="section-title">Î”Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· ÎšÎ±Ï„Î±ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚</h2>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px;">
            <div>
                <h3>Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· ÎÎ­Î¿Ï… Î ÏÎ¿ÏŠÏŒÎ½Ï„Î¿Ï‚</h3>
                <div class="form-group"><input type="text" id="p-name" placeholder="ÎŒÎ½Î¿Î¼Î± Î ÏÎ¿ÏŠÏŒÎ½Ï„Î¿Ï‚"></div>
                <div class="form-group">
                    <select id="p-cat">
                        <option value="ÎšÎµÏÎ¹Î¬">ÎšÎµÏÎ¹Î¬</option>
                        <option value="Wax Melts">Wax Melts</option>
                    </select>
                </div>
                <div class="form-group"><input type="number" id="p-price" placeholder="Î¤Î¹Î¼Î® (â‚¬)"></div>
                <div class="form-group"><input type="text" id="p-img" placeholder="Link Î¦Ï‰Ï„Î¿Î³ÏÎ±Ï†Î¯Î±Ï‚ (URL)"></div>
                <div class="form-group"><textarea id="p-desc" placeholder="Î ÎµÏÎ¹Î³ÏÎ±Ï†Î®"></textarea></div>
                <button class="btn-buy" onclick="addNewProduct()">Î”Î·Î¼Î¿ÏƒÎ¯ÎµÏ…ÏƒÎ·</button>
            </div>
            <div>
                <h3>Î ÏÏŒÏƒÏ†Î±Ï„ÎµÏ‚ Î Î±ÏÎ±Î³Î³ÎµÎ»Î¯ÎµÏ‚</h3>
                <div id="admin-orders">
                    </div>
            </div>
        </div>
    </div>
</div>

<div class="cart-status" onclick="checkout()">
    ğŸ›’ <span id="cart-count">0</span> Î ÏÎ¿ÏŠÏŒÎ½Ï„Î±
</div>

<script>
    // Î£Î—ÎœÎ‘ÎÎ¤Î™ÎšÎŸ: Î‘ÎÎ¤Î™ÎšÎ‘Î¤Î‘Î£Î¤Î—Î£Î• ÎœÎ• Î¤Î‘ Î”Î™ÎšÎ‘ Î£ÎŸÎ¥ Î£Î¤ÎŸÎ™Î§Î•Î™Î‘ Î‘Î ÎŸ Î¤ÎŸ SUPABASE
    const SB_URL = "lujvmovxaseqqogvtvbl";
    const SB_KEY = "sb_publishable_H99zj4Rlm7ScCm3p7l8o4A_eZK0Yc2H";
    const supabase = window.supabase.createClient(SB_URL, SB_KEY);

    let cart = [];

    // 1. Î¦ÎŸÎ¡Î¤Î©ÎœÎ‘ Î Î¡ÎŸÎªÎŸÎÎ¤Î©Î
    async function fetchProducts(category = 'all') {
        let query = supabase.from('products').select('*');
        if (category !== 'all') query = query.eq('category', category);
        
        const { data, error } = await query;
        const grid = document.getElementById('products-grid');
        grid.innerHTML = '';

        if (data) {
            data.forEach(p => {
                grid.innerHTML += `
                    <div class="product-card">
                        <img src="${p.image_url}" class="product-image">
                        <div class="product-info">
                            <h3>${p.name}</h3>
                            <p>${p.description || ''}</p>
                            <div class="price">${p.price}â‚¬</div>
                            <button class="btn-buy" onclick="addToCart('${p.name}', ${p.price})">Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· ÏƒÏ„Î¿ ÎšÎ±Î»Î¬Î¸Î¹</button>
                        </div>
                    </div>`;
            });
        }
    }

    // 2. ÎšÎ‘Î›Î‘Î˜Î™ & Î Î‘Î¡Î‘Î“Î“Î•Î›Î™Î‘
    function addToCart(name, price) {
        cart.push({ name, price });
        document.getElementById('cart-count').innerText = cart.length;
        alert(`${name} Ï€ÏÎ¿ÏƒÏ„Î­Î¸Î·ÎºÎµ!`);
    }

    async function checkout() {
        if (cart.length === 0) return alert("Î¤Î¿ ÎºÎ±Î»Î¬Î¸Î¹ ÎµÎ¯Î½Î±Î¹ Î¬Î´ÎµÎ¹Î¿!");
        
        const name = prompt("ÎŸÎ½Î¿Î¼Î±Ï„ÎµÏ€ÏÎ½Ï…Î¼Î¿:");
        const email = prompt("Email:");
        const address = prompt("Î”Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î®Ï‚:");
        
        if (!name || !email || !address) return;

        const total = cart.reduce((sum, item) => sum + item.price, 0);
        const itemsList = cart.map(i => i.name).join(', ');

        const { error } = await supabase.from('orders').insert([
            { customer_name: name, customer_email: email, address: address, items: itemsList, total: total }
        ]);

        if (!error) {
            alert("Î— Ï€Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î± ÎµÏƒÏ„Î¬Î»Î· Î¼Îµ ÎµÏ€Î¹Ï„Ï…Ï‡Î¯Î±!");
            cart = [];
            document.getElementById('cart-count').innerText = "0";
        }
    }

    // 3. ADMIN Î›Î•Î™Î¤ÎŸÎ¥Î¡Î“Î™Î•Î£
    async function addNewProduct() {
        const name = document.getElementById('p-name').value;
        const category = document.getElementById('p-cat').value;
        const price = document.getElementById('p-price').value;
        const image_url = document.getElementById('p-img').value;
        const description = document.getElementById('p-desc').value;

        const { error } = await supabase.from('products').insert([{ name, category, price, image_url, description }]);
        if (!error) {
            alert("Î¤Î¿ Ï€ÏÎ¿ÏŠÏŒÎ½ Ï€ÏÎ¿ÏƒÏ„Î­Î¸Î·ÎºÎµ!");
            location.reload();
        }
    }

    async function loadAdminOrders() {
        const { data } = await supabase.from('orders').select('*').order('created_at', { ascending: false });
        const container = document.getElementById('admin-orders');
        container.innerHTML = data.map(o => `
            <div style="background:#f9f9f9; padding:10px; margin-bottom:10px; border-left:4px solid var(--primary)">
                <strong>${o.customer_name}</strong> - ${o.total}â‚¬<br>
                <small>${o.items}</small><br>
                <em>${o.address}</em>
            </div>
        `).join('');
    }

    // 4. NAVIGATION
    function showPage(page) {
        const adminView = document.getElementById('admin-view');
        const shopView = document.getElementById('shop-view');
        
        if (page === 'admin') {
            const pass = prompt("ÎšÏ‰Î´Î¹ÎºÏŒÏ‚ Î”Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î®:");
            if (pass === "admin123") { // Î’Î¬Î»Îµ ÏŒÏ€Î¿Î¹Î¿Î½ ÎºÏ‰Î´Î¹ÎºÏŒ Î¸ÎµÏ‚
                adminView.style.display = "block";
                shopView.style.display = "none";
                loadAdminOrders();
            }
        } else if (page === 'keria') {
            adminView.style.display = "none";
            shopView.style.display = "block";
            fetchProducts('ÎšÎµÏÎ¹Î¬');
        } else if (page === 'melts') {
            adminView.style.display = "none";
            shopView.style.display = "block";
            fetchProducts('Wax Melts');
        } else {
            adminView.style.display = "none";
            shopView.style.display = "block";
            fetchProducts();
        }
    }

    // Initial Load
    fetchProducts();
</script>

</body>
</html>
